<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MP3 메타데이터 편집기</title>
    <style>
        body { font-family: sans-serif; }
        .container { width: 400px; margin: 20px auto; }
        label { display: block; margin-bottom: 5px; }
        input[type="text"] { width: 100%; padding: 8px; margin-bottom: 10px; box-sizing: border-box; }
        button { padding: 10px 15px; cursor: pointer; }
        #metadata-display { margin-top: 20px; border: 1px solid #ccc; padding: 10px; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>
    <div class="container">
        <h1>MP3 메타데이터 편집기</h1>
        <button id="select-file-btn">MP3 파일 선택</button>

        <div id="metadata-display" style="display: none;">
            <h2>메타데이터</h2>
            <div id="error-message" class="error"></div>
            <div id="success-message" class="success"></div>
            <label for="title">제목:</label>
            <input type="text" id="title">
            <label for="artist">아티스트:</label>
            <input type="text" id="artist">
            <label for="album">앨범:</label>
            <input type="text" id="album">
            <label for="track">트랙:</label>
            <input type="text" id="track">
            <label for="year">년도:</label>
            <input type="text" id="year">
            <label for="genre">장르:</label>
            <input type="text" id="genre">
            <button id="update-metadata-btn">메타데이터 저장</button>
        </div>
    </div>

    <script>
        const selectFileBtn = document.getElementById('select-file-btn');
        const metadataDisplay = document.getElementById('metadata-display');
        const titleInput = document.getElementById('title');
        const artistInput = document.getElementById('artist');
        const albumInput = document.getElementById('album');
        const trackInput = document.getElementById('track');
        const yearInput = document.getElementById('year');
        const genreInput = document.getElementById('genre');
        const updateMetadataBtn = document.getElementById('update-metadata-btn');
        const errorMessage = document.getElementById('error-message');
        const successMessage = document.getElementById('success-message');

        let currentFilePath = null;

        selectFileBtn.addEventListener('click', async () => {
            const filePath = await window.api.selectMp3File();
            alert(filePath);
            if (filePath) {
                currentFilePath = filePath;
                errorMessage.innerText = '';
                successMessage.innerText = '';
                const metadata = await window.api.getMetadata(filePath);
                if (metadata.error) {
                    errorMessage.innerText = metadata.error;
                    metadataDisplay.style.display = 'none';
                } else {
                    titleInput.value = metadata.title || '';
                    artistInput.value = metadata.artist || '';
                    albumInput.value = metadata.album || '';
                    trackInput.value = metadata.track || '';
                    yearInput.value = metadata.year || '';
                    genreInput.value = metadata.genre || '';
                    metadataDisplay.style.display = 'block';
                }
            }
        });

        updateMetadataBtn.addEventListener('click', async () => {
            if (currentFilePath) {
                const metadata = {
                    title: titleInput.value,
                    artist: artistInput.value,
                    album: albumInput.value,
                    track: trackInput.value,
                    year: yearInput.value,
                    genre: genreInput.value,
                };
                const result = await window.api.updateMetadata(currentFilePath, metadata);
                if (result.error) {
                    errorMessage.innerText = result.error;
                    successMessage.innerText = '';
                } else {
                    successMessage.innerText = result.message;
                    errorMessage.innerText = '';
                }
            } else {
                errorMessage.innerText = '먼저 MP3 파일을 선택해주세요.';
            }
        });
    </script>
</body>
</html>
